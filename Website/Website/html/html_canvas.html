<!DOCTYPE html> 
<html lang="de">
<head> 
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <title> Webhuesli  n00bsoft</title> 
  <meta name="description" content="Steuerung des Webhueslis ueber das Web" /> 
  <link href="../css/3-spalten-layout.css" type="text/css" rel="stylesheet" /> 
  <!--[if IE]> <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script> <![endif]--> 
</head> 

<body> 
<header> 
  <p id="logotext"> 
	<strong>Webhuesli Bedienfeld</strong> 
	</p> 
  <p> 
	Embedded Webhuesli<br /> 
	</p> 
</header> 

<div id="wrapper">

<nav id="steuerungoben"> 
	<ul> 
	<li><a href="../index.html">Home</a></li> 
	
	<li><a href="html_canvas.html">Bedienfeld</a> 
	</ul> 

	<li><a href="html_websocket.html">Terminal</a> 
	</ul> 

</nav> 

<nav id="steuerunglinks"> 
	<p>Kronleuchter </p>
	<div class="container">
		<div class="slider">
			<input id="s_kronleuchter" type = "range" min="0" max="100" value="0" onchange="kronleuchter.value=value, kron_change(this.value)"/>
			<output id="kronleuchter">0</output>
		</div>
	</div>
	
	<p>Lampe </p>
	<div class="container">
		<div class="slider">
			<input id="s_lampe" type = "range" min="0" max="100" value="0" onchange="lampe.value=value, lamp_change(this.value)"/>
			<output id="lampe">0</output>
		</div>
	</div>
	
		<p>Heizung Soll: </p>
	<div class="container">
		<div class="slider">
			<input id="s_heizung" type = "range" min="15" max="30" value="22" onchange="heizung.value=value"/>
			<output id="heizung">22°C</output>
		</div>
	</div>
	<p>Heizung Ist:	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<output id="heizung_ist">22°C</output> </p>
	
	<p>TV:	&nbsp;&nbsp;<output id="tv">OFF</output> </p>
	
	
</nav> 

<aside> 
  <p><em>Validierung:</em></p>
	<p><a href="http://www.ti.bfh.ch"><img src="../bilder/BFH_Logo.png" 
	alt="BFH" height="50" width="auto" background= "fixed" /></a>
  </p>
	<p><a href="http://html5.validator.nu"><img src="../bilder/validator_nu.jpg" 
	alt="Validate HTML5" height="50" width="auto" /></a>
  </p>
  <p><em>Weitere Informationen:</em></p>
	<p><a href="http://www.xkcd.com"><img src="../bilder/small_logo.png" 
	alt="XKCD Webcomic" height="50" width="auto" /></a>
	</p>
	<p><a href="https://github.com/stocyr/Webhuesli"><img src="../bilder/inspectocat.jpg" 
	alt="Git project hosting" height="50" width="auto" /></a>
	</p>
  
</aside> 

<article>
<section> 
	<h1>Droggelbecher</h1> 
<canvas id="myCanvas" width="400" height="350" style="border:1px solid #c3c3c3;">
Your browser does not support the HTML5 canvas tag.
</canvas>



<script>

/* canvas erstellen */
var canvas = document.getElementById("myCanvas");

var ctx=canvas.getContext("2d");

//var rangeslider = document.getElementByID("rangevalue");

/* Handler fuer Mouse-click im canvas-Bereich */ 
function on_canvas_click(ev) {
  // ... x,y sind die absoluten Koordinaten innerhalb des Canvas
  var x = ev.clientX - canvas.offsetLeft;
  var y = ev.clientY - canvas.offsetTop;
  var kl = document.getElementById("s_kronleuchter");
  var lp = document.getElementById("s_lampe");
  var tv_var = document.getElementById("tv");
  
  var message = "Mouse-Position: x=" + x + "y=" + y;
  
  ctx.font="14px Arial";
  ctx.clearRect(0,300,400,50);  /* alten Text loeschen */
  ctx.fillStyle = "#000000";
  ctx.fillText(message,10,315);  /* neuen Text schreiben */
  message = "Kronleuchter: " +kronleuchter.value + " Lampe : " + lampe.value + " Heizung Soll: " +heizung.value +" Ist: " + heizung_ist.value;
  ctx.fillText(message, 10, 330);
  
  
  /* wenn auf Kronleuchter gedrückt */
  if(x > 196 && x < (196 + 22) && y > 156 && y < (156 + 22)){
		
		if(kl.value < 1){
			kl.value = 100;
		}
		else{
			kl.value = 0;
		}
		kl.onchange();
	}
	
	/* wenn auf Lampe gedrückt */
  if(x > 248 && x < (248 + 21) && y > 196 && y < (196 + 17)){
		
		if(lp.value < 1){
			lp.value = 100;
		}
		else{
			lp.value = 0;
		}
		lp.onchange();
	}
	
		/* wenn auf TV gedrückt */
  if(x > 164 && x < (163 + 23) && y > 227 && y < (227 + 14)){
		var tvbild = new Image();
		if(tv.value == "OFF"){
			tv.value = "ON";
			tvbild.src = "../bilder/TV_on.png";
		}
		else{
			tv.value = "OFF";
			tvbild.src = "../bilder/TV_off.png";
		}
		
		tvbild.onload = function() {
			ctx.drawImage(tvbild, 163, 227, 23, 14);
		};	
		
		
	}
	
} 
/* Handler für Ständerlampe, GUI aktualisieren und Kommunikation zum Huesli */
 function lamp_change(slideAmount){
	
	/* Bild zeichnen */
	var img_lampe_on = new Image();
	var img_lampe = new Image();
	
	/* altes Bild loeschen */
	img_lampe.src = "../bilder/Lampe_off.png";
	img_lampe.onload = function() {
		ctx.drawImage(img_lampe, 248, 196, 21, 17);
	};
	img_lampe_on.src = "../bilder/Lampe_on.png";
	img_lampe_on.onload = function() {
		/* Transparenz setzen */
		ctx.globalAlpha = slideAmount/100.0;
		ctx.drawImage(img_lampe_on, 248, 196, 21, 17);
		ctx.globalAlpha = 1.0;
	};
	/* Hier Wert an BeagleBone senden */
	
 }
 
 /* Handler für Kronleuchter, GUI aktualisieren und Kommunikation zum Huesli */
 function kron_change(slideAmount){
	
	/* Bild zeichnen */
	var img_lampe_on = new Image();
	var img_lampe = new Image();
	
	/* altes Bild loeschen */
	img_lampe.src = "../bilder/Kronleuchter_off.png";
	img_lampe.onload = function() {
		ctx.drawImage(img_lampe, 196, 156, 22, 22);
	};
	img_lampe_on.src = "../bilder/Kronleuchter_on.png";
	img_lampe_on.onload = function() {
		/* Transparenz setzen */
		ctx.globalAlpha = slideAmount/100.0;
		ctx.drawImage(img_lampe_on, 196, 156, 22, 22);
		ctx.globalAlpha = 1.0;
	};
	/* Hier Wert an BeagleBone senden */
	
 }
 

 
/* Handler fure Mouse-click registrieren */ 
canvas.addEventListener('click', on_canvas_click, false);



/* Bild zeichnen */
var cat = new Image();
cat.src = "../bilder/haus.png";
cat.onload = function() {
  ctx.drawImage(cat, 0, 0, 400, 300);
};

</script>

	
	
</section> 
</article>

<footer> 
	<p>© 2013 - n00bSoft</p> 
</footer> 

</div>
</body> 
</html>